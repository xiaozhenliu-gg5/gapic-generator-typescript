version: 2
  workflows:
    version: 2
    build_and_test:
      jobs:
        - install:
          filters:
            branches:
              only: add-circleci

        - test:
            requires:
              - install
            filters:
              branches:
                only: add-circleci

  jobs:
    install:
      docker:
        - image: circleci/golang:1.12
      steps:
        - install protoc dependencies
        - run:
            name: install protoc
            command: |
              mkdir protobuf
              curl -sSL https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip > protobuf/protoc.zip
              unzip -d protobuf protobuf/protoc.zip
              export PATH=$PATH:$(pwd)/protobuf/bin
#    test:
#      docker:
#        - image: circleci/mocha:5.2.0
#      steps:
#        - baseline test
#        - run:
#            name: mocha test & cleanup
#            command: |
#              mocha test typescript/test/CodeGeneratorTest.ts
#              rm -r showcase
# TODO: ADD GOOGLE_APPLICATION_KEY IN CONSOLE